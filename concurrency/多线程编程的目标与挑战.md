# 多线程编程的目标与挑战
***

## 线程安全的核心概念
- 原子性： 所有操作要么全部生效要么全部不执行，一种是通过锁实现，另一种是利用处理器提供的专门CAS指令。
- 可见性： 当多个线程并发访问共享变量时，一个线程对共享变量的修改其他线程能否能立即看到。更新操作时是否把数据同步到主内存中。保障可见性可以使用volatile关键字，读取一个volatile修饰的变量会提示处理器执行刷新缓存的动作。
- 有序性： 程序的执行是按照代码的运行顺序执行，通过volatile和synchronized关键字可以保障有序性。

## 上下文切换
一个线程状态在RUNNABLE、BLOCKED、WAITING、TIMED_WAITING之间切换的过程就称为上下文切换，具体涉及到的操作有Thread.sleep()、Object.wait()、Thread.yield()等操作。
### sleep和wait的区别
- sleep是Thread类的方法，而wait是Object类的方法
- wait会释放锁而sleep不会释放锁
- wait、notify只能在同步代码块中使用，而sleep能在任何地方使用。

## 线程故障
- 死锁：资源争抢、占用并等待资源、循环等待资源
- 锁死：没有相应的通知线程去唤醒
- 活锁：线程可能处于Runnable状态，但一直在做无用功。
- 饥饿：无法争抢到资源导致的